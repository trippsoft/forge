syntax = "proto3";

package info;

option go_package = "github.com/trippsoft/forge/pkg/info";

message OSInfoPB {
  string kernel = 1;
  string id = 2;
  string friendly_name = 3;
  string release = 4;
  string release_id = 5;
  string major_version = 6;
  string version = 7;
  string edition = 8;
  string edition_id = 9;
  string arch = 10;
  repeated string families = 11;
}

message FIPSInfoPB {
  bool known = 1;
  bool enabled = 2;
}

message AppArmorInfoPB {
  bool supported = 1;
  bool enabled = 2;
}

message SELinuxInfoPB {
  bool supported = 1;
  bool installed = 2;
  string status = 3;
  string type = 4;
}

message PackageManagerInfoPB {
  string name = 1;
  string path = 2;
}

message ServiceManagerInfoPB {
  string name = 1;
}

message HostInfoPB {
    OSInfoPB os = 1;
    FIPSInfoPB fips = 2;
    AppArmorInfoPB app_armor = 3;
    SELinuxInfoPB selinux = 4;
    PackageManagerInfoPB package_manager = 5;
    ServiceManagerInfoPB service_manager = 6;
}
